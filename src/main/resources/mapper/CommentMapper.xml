<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.test.project.mapper.CommentMapper">

<!-- 댓글 목록 -->
<resultMap type="User" id="User">
	<result column="u_idx" property="uIdx"/>
	<result column="u_name" property="uName"/>
</resultMap>  

<resultMap type="Comment" id="Comment">
	<result column="b_idx" property="bIdx"/>
	<result column="u_idx" property="uIdx"/>
	<result column="b_title" property="bTitle"/>
	<result column="b_content" property="bContent"/>
	<result column="b_redate" property="bRedate"/>
	<result column="a_idx" property="aIdx"/>
	<association property="user" resultMap="User"/>
</resultMap> 

<select id="selectCommentList" parameterType="Comment" resultMap="Comment">
    	  SELECT         ta.*, tb.u_idx, tb.u_name		             
	      FROM           comment ta
	      LEFT JOIN 	 user tb ON ta.u_idx = tb.u_idx	
	      WHERE			 a_idx = #{board.aIdx}				  	  		   	
	      LIMIT			 0,3
</select>

<!-- 댓글 갯수 -->
<select id="commentCount"  resultType="int">
    	  SELECT COUNT(*)	count	             
	      FROM           	comment	  
	      WHERE			 a_idx = #{board.aIdx}				  	  		   	
	      
</select>

<!-- 댓글 작성 -->
<insert id="insertComment" parameterType="Comment">
    	  INSERT INTO comment (
			u_idx,
			a_idx,
			b_content
		) VALUES (
			#{uIdx},
			#{aIdx},
			#{bContent}		
		)			  	  		   	
	      
</insert>






</mapper>